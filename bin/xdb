#!/bin/bash

state="$1"
php_version_string=`php -v`
php_version=`echo $php_version_string | grep -m 1 -o '\d.\d' | head -n 1`
php_config_dir="/usr/local/etc/php/$php_version/conf.d"
xdebug_config_base="ext-xdebug"

if [ ! -d "$php_config_dir" ]; then
    echo "Could not find configuration directory '$php_config_dir'"
    exit 1
fi

if [ -n "$state" ] && [ $state == "on" ]; then

    if [ ! -e "$php_config_dir/ext-xdebug.off" ]; then
        echo "Xdebug already ON."
        exit
    fi

    mv $php_config_dir/ext-xdebug.off $php_config_dir/ext-xdebug.ini
    echo "Xdebug ON."
    exit
fi

if [ -n "$state" ] && [ $state == "off" ]; then
    mv $php_config_dir/ext-xdebug.ini $php_config_dir/ext-xdebug.off
    echo "Xdebug OFF."
    exit
fi

echo "usage: xdb on|off"
